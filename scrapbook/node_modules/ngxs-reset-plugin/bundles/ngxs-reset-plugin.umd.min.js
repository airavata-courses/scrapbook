!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@ngxs/store"),require("rxjs/operators")):"function"==typeof define&&define.amd?define("ngxs-reset-plugin",["exports","@angular/core","@ngxs/store","rxjs/operators"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self)["ngxs-reset-plugin"]={},e.ng.core,e.store,e.rxjs.operators)}(this,(function(e,t,r,n){"use strict";function a(){return function(){}}var s=function(){};s.decorators=[{type:t.Injectable}];var o=function(e,t,a){var s=this;this.actions$=e,this.store=t,this.resetService=a,this.actions$.pipe(r.ofActionSuccessful(r.InitState),n.take(1)).subscribe((function(){return s.resetService.initialState=s.store.snapshot()})),this.actions$.pipe(r.ofActionSuccessful(r.UpdateState)).subscribe((function(e){var t=e.addedStates;return s.resetService.initialState=Object.assign(Object.assign({},s.resetService.initialState),t)}))};o.decorators=[{type:t.Injectable}],o.ctorParameters=function(){return[{type:r.Actions},{type:r.Store},{type:s}]};Object.create;function i(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,s=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=s.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=s.return)&&r.call(s)}finally{if(a)throw a.error}}return o}Object.create;var u=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=v(t.isDevMode());this.statesToKeep=e.reduce(n,[])};u.type="@@CLEAR_STATE";var c=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=v(t.isDevMode());this.statesToReset=e.reduce(n,[])};c.type="@@RESET_STATE";var l=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=v(t.isDevMode());this.statesToKeep=e.reduce(n,[])};l.type="@@RESET_STATE_ALL";var f=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];var n=d(t.isDevMode()),a=i(e.reduce(n,[[],[]]),2),s=a[0],o=a[1];this.statesToOverwrite=s,this.values=o};function p(e,t){var n=new Object(r.getStoreMetadata(e));return n.name&&"defaults"in n||-2!==t?n:(console.warn("Reset Plugin Warning: "+n.name+" is not a state class."),null)}function v(e){return function(t,r){var n=p(r,~e);return n?t.concat(n):t}}function d(e){return function(t,r){var n=i(r,2),a=n[0],s=n[1],o=p(a,~e);return o?[t[0].concat(o),t[1].concat(s)]:t}}f.type="@@OVERWRITE_STATE";var S=function(){function e(e){this.resetService=e}return e.prototype.clearStates=function(e,t){return t.map((function(e){return h(e)})).map((function(t){return{parts:t.split("."),value:r.getValue(e,t)}})).reduce((function(e,t){var r=t.parts,n=t.value;return r.reduceRight((function(t,r){var n,a;return r in e?((n={})[r]=Object.assign(Object.assign({},e[r]),t),n):((a={})[r]=t,a)}),n)}),{})},e.prototype.overwriteStates=function(e,t,n){return t.forEach((function(t,a){return e=r.setValue(e,h(t),n[a])})),e},e.prototype.resetStates=function(e,t){var n=this;return t.forEach((function(t){e=r.setValue(e,h(t),void 0===t.defaults?{}:t.defaults),t.children&&(e=n.resetStates(e,t.children.map(p)))})),e},e.prototype.resetStatesAll=function(e,t){var n=t.map((function(t){return r.getValue(e,h(t))}));return this.overwriteStates(this.resetService.initialState,t,n)},e.prototype.handle=function(e,t,n){switch(r.getActionTypeFromInstance(t)){case u.type:e=this.clearStates(e,t.statesToKeep);break;case c.type:e=this.resetStates(e,t.statesToReset);break;case l.type:e=this.resetStatesAll(e,t.statesToKeep);break;case f.type:var a=t,s=a.statesToOverwrite,o=a.values;e=this.overwriteStates(e,s,o)}return n(e,t)},e}();function h(e){return e.path}S.decorators=[{type:t.Injectable}],S.ctorParameters=function(){return[{type:s}]};var y=function(){function e(){}return e.forRoot=function(){return{ngModule:e,providers:[s,o,{provide:t.APP_INITIALIZER,useFactory:a,deps:[o],multi:!0},{provide:r.NGXS_PLUGINS,useClass:S,multi:!0}]}},e}();y.decorators=[{type:t.NgModule}],e.NgxsResetPlugin=S,e.NgxsResetPluginModule=y,e.StateClear=u,e.StateOverwrite=f,e.StateReset=c,e.StateResetAll=l,e.getMetaData=p,e.ɵa=s,e.ɵb=o,e.ɵd=a,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngxs-reset-plugin.umd.min.js.map