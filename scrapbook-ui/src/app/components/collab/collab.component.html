<div class="card text-dark">
  <div class="card-header h5 d-flex w-100 justify-content-between align-items-center p-0">
    <div>Collaborators</div>
    <div>
      <button mat-icon-button (click)="onClose()">
        <fa-icon [icon]="faTimes" class="h5 m-0 text-dark"></fa-icon>
      </button>
    </div>
  </div>

  <div class="card-body px-0">
    <label>Search Users</label>
    <form class="example-form">
      <input class="form-control bg-light w-100 border-0" placeholder="Type name to search and click to add..."
             [formControl]="control"
             #textInput
             [(ngModel)]="userString"
             (input)="onInputChange(textInput.value)"
             [matAutocomplete]="auto">
      <mat-autocomplete #auto="matAutocomplete">
        <mat-option *ngFor="let user of searchedUsers$ | async" [value]="user.name" (click)="user._id === currentAlbum.createdBy._id || computedCollaborators.includes(user._id) ? '' : onUserSelect(user)" 
        [ngClass]="{'bg-light': user._id === currentAlbum.createdBy._id || computedCollaborators.includes(user._id)}" 
        [disabled]="">
          <div class="d-flex justify-content-between align-items-center text-dark">
            <div class="h6 m-0 d-flex align-content-center">
              <img [src]="user.photo" style="height: 25px; width: 25px; border-radius: 50%;">
              <span class="pl-2">{{user.name}}</span>
            </div>
            <div class="font-italic">
              {{ user._id === currentAlbum.createdBy._id ? 'Owner' : computedCollaborators.includes(user._id) ? 'Collaborator' : ''}}
            </div>
          </div>
        </mat-option>
      </mat-autocomplete>
    </form>
    
    <div class="mt-5">
      <p class="h6 mb-4">People</p>
      <div class="d-flex justify-content-between align-items-center my-2">
        <div class="d-flex align-items-center">
          <img [src]="currentAlbum.createdBy.photo" style="width: 45px; height: 45px; border-radius: 50%;">
          <div class="pl-3">
            <span class="h6 m-0">{{currentAlbum.createdBy.name}}</span>
            <div>{{currentAlbum.createdBy.email}}</div>
          </div>
        </div>
        <div class="h6 m-0">
          Owner
        </div>
      </div>
      <div *ngFor="let collab of currentAlbum.collaborators" class="my-3">
        <div class="d-flex justify-content-between align-items-center">
          <div class="d-flex align-items-center">
            <img [src]="collab.photo" style="width: 45px; height: 45px; border-radius: 50%;">
            <div class="pl-3">
              <span class="h6 m-0">{{collab.name}}</span>
              <div>{{collab.email}}</div>
            </div>
          </div>
          <div class="h6 m-0">
            <button [matMenuTriggerFor]="options" aria-label="Collaborator Options" class="btn btn-light d-flex align-items-center">
              Collaborator <fa-icon [icon]="faSortDown" class="pl-2"></fa-icon>
            </button>
            <mat-menu #options>
              <menu mat-menu-item (click)="onRemoveCollaborator(collab)">Remove</menu>
            </mat-menu>
          </div>
        </div>
      </div>
      
    </div>
  </div>
</div>
